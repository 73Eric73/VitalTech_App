<app-nav></app-nav>

<div class="container">
    <h2>Formulario de registro de pacientes</h2>
    
    <form type="submit" [formGroup]="pacientForm" (ngSubmit)="onSubmit()">
        <div class= "identificador">
            
            <div class = "capzalera4">
                <label for="dni">DNI: <span style="color: red;">*</span></label> 
                <input type="text" id="dni" ngModel name="dni" formControlName="dni" required
                [ngClass]="{'is-invalid': pacientForm.get('dni')?.touched && pacientForm.get('dni')?.invalid || 
                    pacientForm.hasError('dniLletraIncorrect')}">
                    <div class ="error-messages" *ngIf="pacientForm.get('dni')?.touched && pacientForm.get('dni')?.invalid">
                        <small *ngIf="pacientForm.get('dni')?.hasError('required')">Este campo es obligatorio</small>
                        <small *ngIf="pacientForm.get('dni')?.hasError('minlength')">Mínimo 9 carácteres</small>
                        <small *ngIf="pacientForm.get('dni')?.hasError('pattern')">Construido por 8 núm y una letra</small>
                        <small *ngIf="pacientForm.get('dni')?.hasError('pacientIdExistes')">El DNI ya existe</small>
                    </div>
            </div>

            <div class = "masInfo">
                <div class="capzalera1">
                    <label for="SS">Targeta Sanitaria:<span style="color: red;">*</span></label>
                    <input type="text" id="SS" ngModel name="SS" formControlName = "numSS" required
                    [ngClass]="{'is-invalid': pacientForm.get('numSS')?.touched && pacientForm.get('numSS')?.invalid ||
                      pacientForm.hasError('SSLletraIncorrect')}">
                    <div class ="error-messages" *ngIf="pacientForm.get('numSS')?.touched && pacientForm.get('numSS')?.invalid||
                      pacientForm.hasError('SSLletraIncorrect')">
                        <small *ngIf="pacientForm.get('numSS')?.hasError('required')">Este campo es obligatorio</small>
                        <small *ngIf="pacientForm.get('numSS')?.hasError('minlength')">Mínimo 15 carácteres</small>
                        <small *ngIf="pacientForm.get('numSS')?.hasError('maxlength')">Máximo 15 carácteres</small>
                        <small *ngIf="pacientForm.get('numSS')?.hasError('pattern')">Construido por 4 letras y 11 números</small>
                        <small *ngIf="pacientForm.get('numSS')?.hasError('pacientSSExistes')">El num SS ya existe</small>
                        <small *ngIf="pacientForm.hasError('SSLletraIncorrect')">El NSS es invalido</small>
                    </div>
                </div>
            </div>

            <div class = "capzalera1">
                <label for="name">Nombre: <span style="color: red;">*</span></label>
                <input type="text" id="name" ngModel name="name" formControlName="nom" required
                [ngClass]="{'is-invalid': pacientForm.get('nom')?.touched && pacientForm.get('nom')?.invalid}">
                <div class ="error-messages" *ngIf="pacientForm.get('nom')?.touched && pacientForm.get('nom')?.invalid">
                    <small *ngIf="pacientForm.get('nom')?.hasError('required')">Este campo es obligatorio</small>
                </div>
            </div>

            <div class = "capzalera1">
                <label for="sexo">Sexo: <span style="color: red;">*</span></label>
                <select id="selecionSexe" ngModel name="selecionSexe" formControlName="sexe"
                [ngClass]="{'is-invalid': pacientForm.get('sexe')?.touched && pacientForm.get('sexe')?.invalid}">
                    <option value="F">Femenino</option>
                    <option value="M">Masculino</option>
                </select>
                <div class ="error-messages" *ngIf="pacientForm.get('sexe')?.touched && pacientForm.get('sexe')?.invalid">
                    <small *ngIf="pacientForm.get('sexe')?.hasError('required')">Este campo es obligatorio</small>

                </div>
            </div>
        </div>
        <div *ngIf="pacientForm.hasError('dniLletraIncorrect')" class="error-messages">
            <small>DNI invalido</small>
        </div>

        <button type="submit">Registrar</button>
    </form>
</div>